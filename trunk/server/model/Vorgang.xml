<?xml version="1.0"?>
<define>
    <permission package="permission" name="PermissionVorgang"/>

    <model package="vorgang.bom">


        <bean name="Vorgang" persistent="true" unique-key="id" editor="VorgangEditor">
            <field name="nummer"/>
            <field name="id"/>
            <field name="typ"/>
            <collection name="transitions" create="1">
                <bean name="Transition">
                    <field name="name"/>
                    <field name="dir"/>
                    <bean name="Workmodel" create="1">
                        <bean name="Kopf">
                            <field name="mrn"/>
                            <field name="zollstelle"/>
                            <field name="erstellt" type="date"/>
                            <field name="angemeldet" type="Date"/>
                        </bean>
                        <bean name="Geschaeft">
                            <field name="art"/>
                            <field name="betrag"/>
                            <field name="waehrung"/>
                        </bean>
                        <field name="zollstelle_ausfuhr"/>
                        <field name="zollstelle_eam"/>
                        <field name="zollstelle_ausgang"/>
                        <collection name="positionen" create="1" type="Position">
                            <bean name="Position">
                                <field name="nummer"/>
                                <field name="warennummer"/>
                                <field name="roh_gewicht" type="Number"/>
                                <field name="netto_gewicht" type="number"/>
                                <collection name="verschluesse">
                                    <bean name="Verschluss">
                                        <field name="nummer"/>
                                        <field name="zeichen"/>
                                    </bean>
                                </collection>
                                <collection name="packstuecke">
                                    <bean name="Packstueck">
                                        <field name="nummer"/>
                                        <field name="art"/>
                                        <field name="anzahl"/>
                                    </bean>
                                </collection>
                                <collection name="unterlagen">
                                    <bean name="Unterlage">
                                        <field name="nummer"/>
                                        <field name="art"/>
                                        <field name="bezeichnung"/>
                                        <field name="begin"/>
                                        <field name="ende"/>
                                    </bean>
                                </collection>
                            </bean>
                        </collection>
                    </bean>
                </bean>
            </collection>
        </bean>
    </model>

    <view package="vorgang.view" type="Vorgang">
        <tree_editor name="VorgangEditor" label="Ausfuhr {nummer}">
            <tree_node label="Vorgang {nummer}" icon="lorry" type="Vorgang" path="." open="true" panel="default">
                <tree_node label="Transition" path="transitions" icon="arrow.right" type="Transition" open="true" panel="default">
                    <tree_node label="Kopf" path="workmodel" panel="KopfPanel"/>
                    <tree_node label="Positionen" path="workmodel.positionen" type="Position" lister="PositionenLister"  open="true">
                        <command use="CreateNodeCommand" label="neue Position" icon="new"/>
                        <!--<tree_node label="Dokumente {nummer}" path="workmodel.positionen" panel="DokumentePanel"/>-->
                        <tree_node label="Position {nummer}" path="workmodel.positionen" panel="PosPanel">
                            <command use="CreateNodeCommand" label="neue Position" icon="new"/>
                            <command use="CopyNodeCommand" label="Position kopieren" icon="copy"/>
                            <command use="DeleteNodeCommand" label="Position loeschen" icon="delete"/>

                            <!--<tree_node label="Verschluesse" path="verschluesse" type="Verschluss" lister="VerschlussLister">-->
                            <!--<command  use="CreateNodeCommand" label="neuer Verschluss" icon="new"/>-->
                            <!--<tree_node label="Verschluss {nummer}" path="verschluesse" panel="VerschlussPanel" icon="lock"   type="Verschluss">-->
                            <!--<command  use="CreateNodeCommand" label="neuer Verschluss" icon="new"/>-->
                            <!--<command  use="CopyNodeCommand"   label="Verschluss kopieren" icon="copy"/>-->
                            <!--<command  use="DeleteNodeCommand" label="Verschluss loeschen"  icon="delete"/>-->
                            <!--</tree_node>-->
                            <!--</tree_node>-->

                            <!--<tree_node label="Packstuecke" path="packstuecke" type="Packstueck" lister="PackstueckLister">-->
                            <!--<command  use="CreateNodeCommand" label="neues Packstueck" icon="new"/>-->
                            <!--<tree_node label="Packstueck {nummer}" path="packstuecke" panel="PackStueckPanel" icon="pack"  >-->
                            <!--<command  use="CreateNodeCommand" label="neues Packstueck" icon="new"/>-->
                            <!--<command  use="CopyNodeCommand"   label="Packstueck kopieren" icon="copy"/>-->
                            <!--<command  use="DeleteNodeCommand" label="Packstueck loeschen"  icon="delete"/>-->
                            <!--</tree_node>-->
                            <!--</tree_node>-->

                            <!--<tree_node label="Unterlagen" path="unterlagen" type="Unterlage" lister="UnterlagenLister">-->
                            <!--<command  use="CreateNodeCommand" label="neue Unterlage" icon="new"/>-->
                            <!--<tree_node label="Unterlage {art}" path="unterlagen" panel="UnterlagePanel" icon="dock"  >-->
                            <!--<command  use="CreateNodeCommand" label="neue Unterlage" icon="new"/>-->
                            <!--<command  use="CopyNodeCommand"   label="Unterlage kopieren" icon="copy"/>-->
                            <!--<command  use="DeleteNodeCommand" label="Unterlage loeschen"  icon="delete"/>-->
                            <!--</tree_node>-->
                            <!--</tree_node>-->
                        </tree_node>
                    </tree_node>

                </tree_node>
            </tree_node>

            <command use="SaveBoCommand" label="Vorgang speichern" icon="save"/>
            <command use="LoadBoCommand" label="Vorgang laden" icon="refresh"/>
            <command use="DeleteBoCommand" label="Vorgang loeschen" icon="delete"/>

        </tree_editor>

        <!--  ********************* Panels *******************************   -->

        <panel name="KopfPanel" label="Kopfdaten des Vorgangs" gap="3">
            <panel name="KopfAllgemeinPanel" label="Allgemein" border="true" x="10" y="25" path="kopf">
                <input label="MRN" path="mrn" type="string"/>
                <input label="Zollstelle" path="zollstelle" type="lookup"/>
                <input label="erstellt am" path="erstellt" type="date"/>
                <input label="angemeldet am" path="angemeldet" type="date"/>
                <input label="container" path="container" type="Boolean"/>
            </panel>
            <panel name="GeschaeftPanel" label="Geschaeft" border="true" x="10" y="210" path="geschaeft">
                <input label="Geschaeftsart" path="art"/>
                <input label="Waehrung" path="waehrung"/>
                <input label="Betrag" path="betrag"/>
            </panel>
        </panel>

        <panel name="PosPanel">
            <panel name="PosHead" y="10" x="5" label="Warendaten" border="true">
                <input label="Nummer" path="nummer"/>
                <input label="Warennummer" path="warennummer"/>
                <input label="Rohgewicht" path="roh_gewicht" type="number"/>
                <input label="Nettogewicht" path="netto_gewicht" type="number"/>
            </panel>
            <panel use="DokumentePanel" y="10" x="445" border="true" label="Dokumente"/>
        </panel>

        <panel name="DokumentePanel" editable="true" label="Unterlagen PackStuecke Verschluesse">
            <input label="Unterlagen" path="unterlagen" type="list">
                <lister name="UnterlagenLister" type="Unterlage">
                    <command use="CreateNodeCommand" label="neue Unterlage" icon="new"/>
                    <command use="CopyNodeCommand" label="Unterlage kopieren" icon="copy"/>
                    <command use="DeleteNodeCommand" label="Unterlage loeschen" icon="delete"/>
                    <column label="Nummer" path="nummer"/>
                    <column label="Art" path="art"/>
                    <column label="Bezeichnung" path="bezeichnung"/>
                    <column label="Begin" path="begin"/>
                    <column label="Ende" path="ende"/>
                </lister>
            </input>
            <input label="Packstuecke" path="packstuecke" type="list">
                <lister name="PackstueckLister" type="Packstueck">
                    <command use="CreateNodeCommand" label="neues Packstueck" icon="new"/>
                    <command use="CopyNodeCommand" label="Packstueck kopieren" icon="copy"/>
                    <command use="DeleteNodeCommand" label="Packstueck loeschen" icon="delete"/>
                    <column label="Nummer" path="nummer"/>
                    <column label="Art" path="art"/>
                    <column label="Anzahl" path="anzahl"/>
                </lister>
            </input>
            <input label="Verschluesse" path="verschluesse" type="list">
                <lister name="VerschlussLister" type="Verschluss">
                    <command use="CreateNodeCommand" label="neuer Verschluss" icon="new"/>
                    <command use="CopyNodeCommand" label="Verschluss kopieren" icon="copy"/>
                    <command use="DeleteNodeCommand" label="Verschluss loeschen" icon="delete"/>
                    <column label="Nummer" path="nummer"/>
                    <column label="Zeichen" path="zeichen"/>
                </lister>
            </input>
        </panel>

        <!--  ********************* Listen *******************************   -->

        <lister name="VorgangLister" type="Vorgang" label="Vorgaenge">
            <command use="LoadTableCommand" icon="refresh" label="Uebersicht Vorgaenge neu laden"/>
            <command use="OpenEditorCommand" editor="VorgangEditor" label="Vorgang oeffnen" icon="edit"/>
            <command use="DeleteBoCommand" label="Vorgang loeschen" icon="delete"/>

            <column label="Nummer" path="nummer"/>
            <column label="Id" path="id"/>
            <column label="Typ" path="typ"/>
        </lister>

        <lister name="PositionenLister" type="Postion" label="Ware" >
            <column label="Nummer" path="nummer"/>
            <column label="Warennummer" path="warennummer"/>
            <column label="Rohgewicht" path="roh_gewicht"/>
            <column label="Nettogewicht" path="netto_gewicht"/>
        </lister>

    </view>

</define>




