<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml"
                layout="absolute" width="332" height="260"
                title="Suche" showCloseButton="true"
                backgroundColor="#C0C0C0"
                close="close()"
                cornerRadius="4"
         xmlns:ns1="de.ama.framework.gui.frames.*"
        creationComplete="init()">

    <mx:Script><![CDATA[
        import de.ama.framework.data.SelectionModel;
        import de.ama.framework.util.Callback;

        import mx.managers.PopUpManager;

        private function init():void {
            listPanel.doubleClickCallback = new Callback(this, onListDoubleClick);
        }

        private var _lister:String = "default";
        private var _callback:Callback = null;
        private var _boRef:BoReference = null;

        public function setCallback(cb:Callback):void {
            _callback = cb;
        }

        public function setDataTable(arr:Array):void {
            listPanel.dataTable = arr;
        }

        private function callback():void {
            if (_callback != null) {
                _callback.execute(this);
            }
        }

        public function close():void {
            PopUpManager.removePopUp(this);
            callback();
        }

        public function keyHandler(e:KeyboardEvent):void {
        }

        private function onListDoubleClick(lp:ListPanel):void {
            okButtonHandler();
        }

        private function okButtonHandler():void {
            var sm:SelectionModel = listPanel.getSelectionModel();
            _data = sm.getFirstSelection();
            close();
        }


        public function get lister():String {
            return _lister;
        }

        public function set lister(value:String):void {
            _lister = value;
        }

        public function get selection():Data {
            return _data;
        }

        ]]></mx:Script>


    <mx:VBox width="100%">

        <ns1:ListPanel id="listPanel" width="100%" />

        <mx:HBox width="100%" bottom="0" horizontalAlign="right" horizontalGap="0">
            <mx:Button label="ok" click="okButtonHandler()"/>
            <mx:Button label="close" click="close()"/>
        </mx:HBox>
    </mx:VBox>

</mx:TitleWindow>
