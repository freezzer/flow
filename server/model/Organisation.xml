<?xml version="1.0"?>
<!DOCTYPE define SYSTEM "model.dtd">

<define>

    <model package="bom">

        <bean name="Organisation" persistent="true">
            <field name="name"/>
            <field name="adresse" type="Adresse" create="true"/>
            <collection name="personen" type="Person" create="1"/>
            <collection name="notizen" create="1">
                <bean name="Notiz">
                    <field name="kontaktperson" type="Person"/>
                    <field name="erfasser" type="Person"/>
                    <field name="datum" type="date"/>
                    <field name="text"/>
                    <field name="todo"/>
                </bean>
            </collection>
        </bean>
    </model>

    <permission package="permission" name="Organisation">

        <view package="view.organisation">

            <lister name="OrganisationenLister" label="Uebersicht Organisationen" type="Organisation">
                <command use="LoadTableCommand" icon="refresh" label="Uebersicht Organisationen neu laden"/>
                <command use="OpenEditorCommand" editor="OrganisationenEditor" label="Organisation bearbeiten" icon="edit"/>
                <command use="DeleteBoCommand" label="Organisation loeschen" icon="delete"/>
                <command use="OpenNewEditorCommand" editor="OrganisationenEditor" label="neue Organisation oeffnen" />

                <column path="name" label="Name"         searchable="true"/>
                <column path="adresse.land" label="Land" searchable="true"/>
                <column path="adresse.ort" label="Ort"   searchable="true"/>
                <!--<column path="adressen.Adresse[1]/ort" label="1. Adresse" searchable="true"/>-->
            </lister>

            <tree_editor name="OrganisationenEditor" label="Daten von {name} " type="Organisation">
                <tree_node label="Organisation" path="." type="Organisation" icon="building" open="true" panel="default">
                    <tree_node label="Adresse {ort}" path="adresse" icon="form" open="true" type="Adresse"  panel="AdressePanel" />
                    <tree_node label="Personen" path="personen" icon="table" open="true" type="Person"  lister="PersonLister">
                        <command use="CreateNodeCommand" label="neue Person" icon="new"/>
                        <tree_node label="Kontakt {name}" path="personen" icon="user" open="true" type="Person"
                                   panel="default">
                            <command use="CreateNodeCommand" label="neue Adresse" icon="new"/>
                            <command use="CopyNodeCommand" label="Adresse kopieren" icon="copy"/>
                            <command use="DeleteNodeCommand" label="Adresse loeschen" icon="delete"/>
                        </tree_node>
                    </tree_node>
                    <tree_node label="Notizen" path="notizen" icon="table" open="true" type="Notiz"  lister="default">
                        <command use="CreateNodeCommand" label="neue Notiz" icon="new"/>
                        <tree_node label="Notiz {name}" path="notizen" icon="dock" open="true" type="Notiz"
                                   panel="NotizPanel">
                            <command use="CreateNodeCommand" label="neue Notiz" icon="new"/>
                            <command use="CopyNodeCommand" label="Notiz kopieren" icon="copy"/>
                            <command use="DeleteNodeCommand" label="Notiz loeschen" icon="delete"/>
                        </tree_node>
                    </tree_node>
                </tree_node>

                <command use="SaveBoCommand" label="Organisation speichern" icon="save"/>
                <command use="LoadBoCommand" label="Organisation laden" icon="refresh"/>
                <command use="DeleteBoCommand" label="Organisation loeschen" icon="delete"/>
            </tree_editor>

            <panel name="NotizPanel" border="true" x="25" y="25" label="Notiz">
                <lookup x="10" y="41" w="300" labelwidth="50" label="Kontakt" path="kontaktperson" type="Person" guirep="vorname"/>
                <lookup x="10" y="68" w="300" labelwidth="50" label="Erfasser" path="erfasser"     type="Person" guirep="vorname"/>
                <input x="10" y="13" w="265" labelwidth="50" h="25" label="erfasst" path="datum" type="date" />
                <input x="10" y="99" w="300" labelwidth="50" h="74" label="Notiz" path="text" type="area" />
                <input x="10" y="176" w="300" labelwidth="50" h="74" label="ToDo" path="todo" type="area" />
            </panel>
            

        </view>

    </permission>

</define>




